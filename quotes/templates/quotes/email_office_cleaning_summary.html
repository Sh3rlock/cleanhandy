{% load quote_filters %}
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <style>
    body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; padding: 20px; }
    h2, h4 { color: #2c3e50; }
    .section { margin-bottom: 30px; }
    .section h4 { border-bottom: 1px solid #ccc; padding-bottom: 5px; }
    .list-item { margin-left: 20px; }
    .bold { font-weight: bold; }
    .highlight { background-color: #f8f9fa; padding: 15px; border-radius: 5px; margin: 10px 0; }
  </style>
</head>
<body>
  <h2>üè¢ Office Cleaning Booking Confirmed!</h2>
  <p>Thank you, {{ booking.name }}! Your office cleaning service has been successfully booked.</p>

  <div class="section">
    <h4>üìã Service Details</h4>
    <div class="highlight">
      <p><strong>Business Type:</strong> {{ booking.business_type|title }}</p>
      <p><strong>Crew & Duration:</strong> {{ booking.crew_size_hours|title }}</p>
      <p><strong>Cleaning Frequency:</strong> {{ booking.cleaning_frequency|title }}</p>
      {% if booking.hear_about_us %}
        <p><strong>How you heard about us:</strong> {{ booking.hear_about_us|title }}</p>
      {% endif %}
    </div>
  </div>

  <div class="section">
    <h4>üìÖ Schedule Information</h4>
    <div class="highlight">
      <p><strong>Date:</strong> {{ booking.date|date:"F j, Y" }}</p>
      <p><strong>Time:</strong> {{ booking.hour|time:"g:i A" }}</p>
      <p><strong>Duration:</strong> {{ booking.hours_requested }} hour{{ booking.hours_requested|pluralize }}</p>
      <p><strong>Number of Cleaners:</strong> {{ booking.num_cleaners }}</p>
    </div>
  </div>

  <div class="section">
    <h4>üìç Service Location</h4>
    <div class="highlight">
      <p><strong>Address:</strong> {{ booking.address }}{% if booking.apartment %}, Apt {{ booking.apartment }}{% endif %}</p>
      <p><strong>City:</strong> {{ booking.city|default:"New York" }}</p>
      <p><strong>State:</strong> {{ booking.state|default:"NY" }}</p>
      <p><strong>ZIP Code:</strong> {{ booking.zip_code }}</p>
    </div>
  </div>

  <div class="section">
    <h4>üí∞ Price Breakdown</h4>
    <div class="highlight">
      <p class="list-item">Labor Cost: ${{ booking.num_cleaners }} √ó {{ booking.hours_requested }} hour{{ booking.hours_requested|pluralize }} √ó ${{ hourly_rate }}/hour = ${{ labor_cost|floatformat:2 }}</p>
      {% if discount_amount > 0 %}
        <p class="list-item">Frequency Discount ({{ discount_percent }}%): -${{ discount_amount|floatformat:2 }}</p>
      {% endif %}
      <p class="list-item">Subtotal: ${{ subtotal|floatformat:2 }}</p>
      <p class="list-item">Sales Tax (8.875%): ${{ tax|floatformat:2 }}</p>
      <p class="list-item bold">Total: ${{ booking.price|floatformat:2 }}</p>
    </div>
  </div>

  {% if booking.get_paid_amount > 0 %}
  <div class="section">
    <h4>üí≥ Payment Summary</h4>
    <div class="highlight" style="background-color: #e8f5e8; border-left: 4px solid #28a745;">
      <p><strong>Type:</strong> {{ booking.get_payment_type_for_display }}</p>
      <p><strong>Paid:</strong> ‚Ç¨{{ booking.get_paid_amount|floatformat:2 }}</p>
      {% if booking.get_paid_amount < booking.price %}
        <p><strong>Remaining:</strong> ‚Ç¨{{ booking.price|sub:booking.get_paid_amount|floatformat:2 }}</p>
      {% else %}
        <p><strong>Status:</strong> <span style="color: #28a745; font-weight: bold;">Fully Paid</span></p>
      {% endif %}
    </div>
  </div>
  {% endif %}

  {% if booking.job_description %}
  <div class="section">
    <h4>üìù Special Instructions</h4>
    <div class="highlight">
      <p>{{ booking.job_description }}</p>
    </div>
  </div>
  {% endif %}

  <div class="section">
    <h4>üìû Contact Information</h4>
    <div class="highlight">
      <p><strong>Name:</strong> {{ booking.name }}</p>
      <p><strong>Email:</strong> {{ booking.email }}</p>
      <p><strong>Phone:</strong> {{ booking.phone }}</p>
    </div>
  </div>

  <div class="section">
    <h4>‚ÑπÔ∏è Important Notes</h4>
    <ul>
      <li>Please ensure access to the premises at the scheduled time</li>
      <li>Our team will arrive with all necessary cleaning supplies and equipment</li>
      <li>If you need to reschedule, please contact us at least 24 hours in advance</li>
      <li>Payment is due upon completion of service</li>
    </ul>
  </div>

  <p>Thank you for choosing TheCleanHandy for your office cleaning needs!</p>
  <p>If you have any questions, please don't hesitate to contact us.</p>

  <hr>
  <p><small>This is an automated confirmation email. Please do not reply to this message.</small></p>
</body>
</html>
