{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>CleanHandy</title>

    <!-- Stylesheets -->
    <link href="{% static 'assets/css/style.css' %}" rel="stylesheet" />

    <link rel="shortcut icon" href="{% static '/assets/images/favicon.png' %}" type="image/x-icon" />
    <link rel="icon" href="{% static '/assets/images/favicon.png' %}" type="image/x-icon" />

    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>

  <body>
    <style>
      /* General placeholder style */
      input::placeholder {
        color: #999;  /* or any lighter grey */
        opacity: 1;   /* Safari ignores opacity if not set */
      }
    </style>
    <div class="page-wrapper">
      
      <!-- header -->
      <header class="main-header header-style-one">
        <!-- Header Lower -->
        <div class="header-lower">
          <div class="container">
            <div class="inner-container d-flex align-items-center justify-content-between">
              <div class="header-left-column">
                <div class="logo-box">
                  <div class="logo">
                    <a href="{% url 'home' %}"><img src="{% static '/assets/images/logo.png' %}" alt="logo" /></a>
                  </div>
                </div>
              </div>
              <div class="header-center-column">
                <div class="nav-outer">
                  <div class="mobile-nav-toggler">
                    <img src="{% static '/assets/images/icons/icon-bar.png' %}" alt="icon" />
                  </div>
                  <nav class="main-menu navbar-expand-md navbar-light">
                    <div class="collapse navbar-collapse show clearfix" id="navbarSupportedContent">
                      <ul class="navigation">
                        <li>
                          <a href="{% url 'home' %}">Home</a>
                        </li>

                        <li class="dropdown">
                          <a href="javascript:void(0);">All Services</a>
                          <ul>
                            {% for service in all_services %}
                              <li>
                                {% if service.category.name|lower == 'cleaning' %}
                                  <a href="{% url 'request_cleaning_quote' service.id %}">{{ service.name }}</a>
                                {% elif service.category.name|lower == 'handyman' %}
                                  <a href="{% url 'request_handyman_quote' service.id %}">{{ service.name }}</a>
                                {% else %}
                                  <a href="#">{{ service.name }} (Unknown Category)</a>
                                {% endif %}
                              </li>
                            {% endfor %}
                          </ul>
                        </li>
                        <li>
                            <a href="{% url 'about' %}">About Us</a>
                          </li>
                        <li>
                          <a href="{% url 'blog' %}">Blog</a>
                        </li>
                        <li>
                          <a href="{% url 'contact' %}">Contact</a>
                        </li>
                      </ul>
                    </div>
                  </nav>
                </div>
              </div>
              <div class="header-right-column d-flex align-items-center">
                <div class="header-right-contact">
                  <a href="tel:+48615579822"><i class="icon-call-2"></i> +48 615 579 822</a>
                </div>
                <div class="header-right-btn-area">
                  {% if user.is_authenticated %}
                      <a href="{% url 'profile' %}" class="btn-1">My Profile</a>
                  {% else %}
                    <a href="#" class="btn-1" data-bs-toggle="modal" data-bs-target="#loginModal">Sign In</a>
                    <a href="#" class="btn-1" data-bs-toggle="modal" data-bs-target="#registerModal">Sign Up</a>
                  {% endif %}
                </div>
                
              </div>
            </div>
          </div>
        </div>
        <!-- Header Lower -->

        <!-- sticky header -->
        <div class="sticky-header">
          <div class="header-upper">
            <div class="container">
              <div class="inner-container d-flex align-items-center justify-content-between">
                <div class="left-column d-flex align-items-center">
                  <div class="logo-box">
                    <div class="logo">
                      <a href="index.html"><img src="{% static '/assets/images/logo.png' %}" alt="logo" /></a>
                    </div>
                  </div>
                </div>

                <div class="nav-outer gap-5 d-flex align-items-center">
                  <div class="mobile-nav-toggler">
                    <img src="{% static '/assets/images/icons/icon-bar.png' %}" alt="icon" />
                  </div>
                  <nav class="main-menu navbar-expand-md navbar-light"></nav>
                </div>

                <div class="header-right-column d-flex align-items-center">
                  <div class="header-right-contact">
                    <a href="tel:+48615579822"><i class="icon-call-2"></i> +48 615 579 822</a>
                  </div>
                  <div class="header-right-btn-area">
                    {% if user.is_authenticated %}
                        <a href="{% url 'profile' %}" class="btn-1">My Profile</a>
                    {% else %}
                    <!-- Example buttons to trigger the modals -->
                      <a href="#" class="btn-1" data-bs-toggle="modal" data-bs-target="#loginModal">Sign In</a>
                      <a href="#" class="btn-1" data-bs-toggle="modal" data-bs-target="#registerModal">Sign Up</a>
                    {% endif %}
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- sticky header -->

        <!-- mobile menu -->
        <div class="mobile-menu">
          <div class="menu-backdrop"></div>
          <div class="close-btn">
            <span class="fal fa-times"></span>
          </div>

          <nav class="menu-box">
            <div class="nav-logo">
              <a href="index.html"><img src="{% static '/assets/images/logo.png' %}" alt="logo" /></a>
            </div>
            <div class="menu-outer">
              <!-- Here Menu Will Come Automatically Via Javascript / Same Menu as in Header -->
            </div>
            <!-- Social Links -->
            <div class="social-links">
              <ul class="clearfix">
                <li>
                  <a href="#"><span class="fab fa-twitter"></span></a>
                </li>
                <li>
                  <a href="#"><span class="fab fa-facebook-square"></span></a>
                </li>
                <li>
                  <a href="#"><span class="fab fa-pinterest-p"></span></a>
                </li>
                <li>
                  <a href="#"><span class="fab fa-instagram"></span></a>
                </li>
                <li>
                  <a href="#"><span class="fab fa-youtube"></span></a>
                </li>
              </ul>
            </div>
          </nav>
        </div>
      </header>
      <!-- header -->

      {% block content %}
      {% endblock %}

      <!-- footer -->
      <footer id="footer" class="main-footer footer-one">
        <div class="container">
          <div class="footer-top">
            <div class="footer-top-logo">
              <img src="assets/images/logo.png" alt="logo" />
            </div>
            <div class="social-media">
              <ul>
                <li>
                  <a href="#0"><i class="fa-brands fa-facebook-f"></i></a>
                </li>
                <li>
                  <a href="#0"><i class="icon-twiter"></i></a>
                </li>
                <li>
                  <a href="#0"><i class="fa-brands fa-linkedin-in"></i></a>
                </li>
                <li>
                  <a href="#0"><i class="fa-brands fa-instagram"></i></a>
                </li>
              </ul>
            </div>
          </div>
          <div class="footer-widget-container">
            <div class="row">
              <div class="col-xl-3 col-lg-4 col-md-6">
                <div class="footer-widget about-widget">
                  <div class="about-widget-inner">
                    <h6 class="footer-widget-title">About us</h6>
                    <p>It is a long established fact that a reader will be distracted by the readable counter of a page.</p>
                  </div>
                </div>
              </div>
              <div class="col-xl-3 col-lg-4 col-md-4">
                <div class="footer-widget company-widget">
                  <div class="company-widget-inner">
                    <h6 class="footer-widget-title">Company</h6>
                    <ul class="footer-widget-list">
                      <li>
                        <a href="contact.html">Contact Us</a>
                      </li>
                      <li>
                        <a href="blog.html">Servat Blog</a>
                      </li>
                      <li>
                        <a href="blog.html">Engineering Blog</a>
                      </li>
                      <li>
                        <a href="workers.html">Marketplace</a>
                      </li>
                      <li>
                        <a href="workers.html">Social Good</a>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
              <div class="col-xl-2 col-lg-4 col-md-2">
                <div class="footer-widget support-widget">
                  <div class="support-widget-inner">
                    <h6 class="footer-widget-title">Support</h6>
                    <ul class="footer-widget-list">
                      <li>
                        <a href="contact.html">Help Topics</a>
                      </li>
                      <li>
                        <a href="blog-details.html">Post A Job</a>
                      </li>
                      <li>
                        <a href="contact.html">Servat Pro</a>
                      </li>
                      <li>
                        <a href="#0">FAQs</a>
                      </li>
                      <li>
                        <a href="contact.html">Verify</a>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
              <div class="col-xl-4 col-lg-6 col-md-8">
                <div class="footer-widget newsletter-widget">
                  <div class="newsletter-widget-inner">
                    <h6 class="footer-widget-title">Join Our Newsletter</h6>
                    <div class="footer-newsletter-info">
                      <div class="footer-newsletter-form">
                       
                        <form id="newsletter-form" method="post">
                          {% csrf_token %}
                          {{ newsletter_form.email }}
                        
                          <div class="checkbox-input flex items-center mt-2">
                            <input  type="checkbox" name="agree_terms" id="agree_terms" class="form-check-input" required />
                            <label for="agree_terms" class="ml-2">
                              I agree to the <a href="/terms" class="text-blue-500 underline">Terms and Conditions</a>
                            </label>
                          </div>
                        
                          <button type="submit" class="btn-1">Subscribe <i class="icon-arrow-1"></i></button>
                        </form>
                        
                        <div id="newsletter-message" class="mt-2 text-sm"></div>
                    
                      
                      
                      </div>
                      <div class="footer-contact-info">
                        <a href="#0"><i class="fa-light fa-location-dot"></i> Australia Wise 9297 Maxim AV. Antonio, USA.</a>
                        <a href="mailto:example@gmail.com"><i class="fa-light fa-envelope"></i> example@gmail.com</a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="footer-copyright">
          <div class="container">
            <div class="footer-copyright-content">
              <p>
                &copy; 2024 – 2030 | Alrights reserved By <a href="#0">binary-vines</a>
              </p>
              <div class="footer-terms">
                <a href="#0">Privacy Policy</a>
                <a href="#0">Terms & Conditions</a>
              </div>
            </div>
          </div>
        </div>
      </footer>
      <!-- footer -->
    </div>

    <!-- Scroll to top -->
    <div class="scroll-to-top">
      <div>
        <div class="scroll-top-inner">
          <div class="scroll-bar">
            <div class="bar-inner"></div>
          </div>
          <div class="scroll-bar-text">Go To Top</div>
        </div>
      </div>
    </div>
    <!-- Scroll to top end -->

    <!-- Login Modal -->
<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form method="post" action="{% url 'login' %}">
        {% csrf_token %}
        <div class="modal-header">
          <h5 class="modal-title">Login</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          {{ login_form.as_p }}
          <p class="text-center mb-0 mt-0">
            Don't have an account? <a href="{% url 'register' %}" class="fw-semibold text-decoration-none">Sign Up</a>
          </p>
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn-1 w-100">Login</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Register Modal -->
<div class="modal fade" id="registerModal" tabindex="-1" aria-labelledby="registerModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form id="registerForm" method="post" action="{% url 'register' %}">
        {% csrf_token %}

        <div class="modal-header border-0 pb-0">
          <h5 class="modal-title fw-bold" id="registerModalLabel">Create Your Account</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>

        <div class="modal-body pt-0">
          {% if register_form.non_field_errors %}
            <div class="alert alert-danger">
              {{ register_form.non_field_errors }}
            </div>
          {% endif %}

          {% for field in register_form %}
            <div class="mb-3">
              <label for="{{ field.id_for_label }}" class="form-label fw-semibold">{{ field.label }}</label>
              {{ field }}

              

              {% if field.errors %}
                <div class="text-danger small py-2">{{ field.errors|striptags }}</div>
              {% endif %}
            </div>
          {% endfor %}
          <!-- Placeholder for AJAX errors -->
        <div id="register-errors" class="text-danger mt-2 d-none py-2"></div>
        </div>
        

        <div class="modal-footer border-0 pt-0">
          <button type="submit" class="btn-1 w-100 py-2">Register</button>
        </div>
      </form>
      
    </div>
  </div>
</div>



    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const form = document.getElementById("newsletter-form");
        const messageBox = document.getElementById("newsletter-message");
        const termsCheckbox = document.getElementById("agree_terms");
      
        form.addEventListener("submit", function (e) {
          e.preventDefault();
      
          // Clear old styles
          messageBox.className = "mt-2 text-sm";
          messageBox.innerText = "";
      
          // Check terms box
          if (!termsCheckbox.checked) {
            messageBox.innerText = "You must agree to the terms.";
            messageBox.classList.add("text-red-600");
            return;
          }
      
          const formData = new FormData(form);
      
          fetch("{% url 'subscribe_newsletter' %}", {
            method: "POST",
            headers: {
              'X-CSRFToken': form.querySelector('[name=csrfmiddlewaretoken]').value,
            },
            body: formData
          })
          .then(response => response.json())
          .then(data => {
            messageBox.innerText = data.message;
      
            if (data.status === "success") {
              messageBox.style.color = "#28a745"; // green
              form.reset();
            } else if (data.status === "info") {
              messageBox.style.color = "#007bff"; // blue
            } else {
              messageBox.style.color = "#F15A29"; // orange
            }

            messageBox.style.fontSize = "1.1rem";
            messageBox.style.fontWeight = "600";
          })
          .catch(() => {
            messageBox.innerText = "Something went wrong. Please try again.";
            messageBox.classList.add("text-red-600");
          });
        });
      });
      </script>

      <script>
        document.getElementById('registerForm').addEventListener('submit', async function (e) {
          e.preventDefault();
        
          const form = e.target;
          const formData = new FormData(form);
          const errorsContainer = document.getElementById('register-errors');
        
          // Clear old errors and hide by default
          errorsContainer.innerHTML = "";
          errorsContainer.classList.add("d-none");
        
          const response = await fetch(form.action, {
            method: 'POST',
            body: formData,
            headers: {
              'X-Requested-With': 'XMLHttpRequest',
            },
          });
        
          const data = await response.json();
        
          if (data.success) {
            const modal = bootstrap.Modal.getInstance(document.getElementById('registerModal'));
            modal.hide();
            location.reload(); // Or display a success message
          } else {
            errorsContainer.classList.remove("d-none"); // Show error box
            data.errors.forEach(msg => {
              const div = document.createElement('div');
              div.classList.add("alert", "alert-danger", "py-2", "px-2", "mb-2");
              div.textContent = msg;
              errorsContainer.appendChild(div);
            });
          }
        });
        </script>
        
        
      

    <script src="{% static '/assets/js/jquery.min.js' %}"></script>
    <script src="{% static '/assets/js/bootstrap.min.js' %}"></script>
    <script src="{% static '/assets/js/select2.min.js' %}"></script>
    <script src="{% static '/assets/js/jquery.nice-select.min.js' %}"></script>
    <script src="{% static '/assets/js/appear.js' %}"></script>
    <script src="{% static '/assets/js/wow.js' %}"></script>
    <script src="{% static '/assets/js/TweenMax.min.js' %}"></script>
    <script src="{% static '/assets/js/odometer.min.js' %}"></script>
    <script src="{% static '/assets/js/swiper.min.js' %}"></script>
    <script src="{% static '/assets/js/parallax-scroll.js' %}"></script>
    <script src="{% static '/assets/js/jarallax.min.js' %}"></script>
    <script src="{% static '/assets/js/jquery.paroller.min.js' %}"></script>
    <script src="{% static '/assets/js/jquery.magnific-popup.min.js' %}"></script>
    <script src="{% static '/assets/js/isotope.js' %}"></script>
    <script src="{% static '/assets/js/flatpickr-min.js' %}"></script>
    <script src="{% static '/assets/js/socialSharing.js' %}"></script>
    <script src="{% static '/assets/js/script.js' %}"></script>
    {% block modals %}{% endblock %}
  </body>
</html>
